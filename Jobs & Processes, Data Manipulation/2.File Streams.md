# File Streams

## 1. L·ªánh **`head`** v√† **`tail`**

**`head`** v√† **`tail`** l√† 2 l·ªánh cho ph√©p b·∫°n ch·ªçn v√† hi·ªÉn th·ªã m·ªôt √≠t d√≤ng ƒë·∫ßu ti√™n ho·∫∑c √≠t d√≤ng cu·ªëi c√πng t·ª´ m·ªôt **file** ho·∫∑c ƒë·∫ßu ra **stream** t∆∞∆°ng ·ª©ng. M·∫∑c ƒë·ªãnh th√¨ c·∫£ hai s·∫Ω ch·ªçn 10 d√≤ng, nh∆∞ng s·ª≠ d·ª•ng tu·ª≥ ch·ªçn **`-n`** b·∫°n c√≥ th·ªÉ ch·ªâ ƒë·ªãnh s·ªë b·∫°n mu·ªën.

**`V√≠ d·ª•:`** B·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng l·ªánh **`tail`** ƒë·ªÉ ch·ªçn 5 d√≤ng cu·ªëi c·ªßa m·ªôt **file** nh∆∞ sau:

```shell
tail -n5 /Users/zenfection/Desktop/kiet.txt
```

![2020-08-15 23.45.46.gif](https://raw.githubusercontent.com/Zenfection/Image/master/2020/08/15-23-46-26-2020-08-15%2023.45.46.gif)

T∆∞∆°ng t·ª± nh∆∞ v·∫≠y, B·∫°n c√≥ th·ªÉ d√πng l·ªánh **`head`** ƒë·ªÉ ch·ªçn v√† hi·ªán th·ªã 5 d√≤ng ƒë·∫ßu nh∆∞ sau:

```shell
head -n5 /Users/zenfection/Desktop/kiet.txt
```

![2020-08-15 23.47.47.gif](https://raw.githubusercontent.com/Zenfection/Image/master/2020/08/15-23-48-26-2020-08-15%2023.47.47.gif)

### S·ª≠ d·ª•ng l·ªánh **`tail -f`**

√Åp d·ª•ng tu·ª≥ ch·ªçn **`-f`** (*follow*) ƒë·ªÉ l·ªánh **`tail`** s·∫Ω kh√¥ng d·ª´ng ƒë·∫øn khi ƒë·∫°t t·ªõi cu·ªëi **file**. H√£y th·ª≠ l·ªánh sau ƒë√¢y:

```shell
tail -f var/log/messages
```

Trong **Linux**, **``/var/log/messages``** l√† "*system log file*". Nh∆∞ l√† th√™m m·ª•c nh·∫≠t k√Ω m·ªõi v√†o **file**, v√† l·ªánh **`tail -f`** s·∫Ω hi·ªÉn th·ªã ch√∫ng.

ƒêi·ªÅu n√†y nh∆∞ b·∫°n g·ªçi "*tailing a log file*" ho·∫∑c "*taling a file*"

### S·ª≠ d·ª•ng **`head`** v√† **`tail`** v·ªõi **`|`**

N√≥ c≈©ng ph·ªï bi·∫øn s·ª≠ d·ª•ng **`head`** v√† **`tail`** ƒë·ªÉ l·ªçc ƒë·∫ßu ra c·ªßa m·ªôt ch∆∞∆°ng tr√¨nh kh√°c, h√£y th·ª≠ l·ªánh sau:

```shell
ls -t | head -n3
ls -t | tail -n3
```

L·ªánh **`ls -t`** s·∫Ω hi·ªÉn th·ªã danh s√°ch c·ªßa n·ªôi dung **directory** hi·ªán t·∫°i s·∫Øp x·∫øp b·ªüi th·ªùi gian s·ª≠a ƒë·ªïi (*l·∫ßn g·∫ßn ƒë√¢y nh·∫•t*). N√™n l·ªánh **`ls -t | head -n3`** s·∫Ω hi·ªÉn th·ªã danh s√°ch c·ªßa  **3 files** g·∫ßn ƒë√¢y nh·∫•t, c√≤n l·ªánh **`ls -t | tail -n3`** s·∫Ω hi·ªÉn th·ªã ra **3 files** c≈© nh·∫•t.

---

## 2. Ph√¢n trang trong file l·ªõn s·ª≠ d·ª•ng **`less`**

L·ªánh **`less`** cho ph√©p b·∫°n cu·ªôn v√† t√¨m ki·∫øm th√¥ng qua c√°c **streams** c·ªßa ƒë·∫ßu ra m·ªôt file r·∫•t l·ªõn

**V√≠ d·ª• nh∆∞ sau:**

```shell
ps aux | less
```

**`ps aux`** s·∫Ω in chi ti·∫øt th√¥ng tin v·ªÅ ti·∫øn tr√¨nh hi·ªán t·∫°i ƒëang ch·∫°y v√† c√≥ th·ªÉ chi·∫øm nhi·ªÅu m√†n h√¨nh hi·ªán th·ªã c√≥ vƒÉn b·∫£n. B·∫±ng c√°ch ƒë∆∞a ƒë·∫ßu ra n√≥ √≠t h∆°n b·∫±ng **`less`** ch√∫ng ta c√≥ th·ªÉ cu·ªôn ƒë·ªÉ xem th√¥ng tin d·ªÖ h∆°n.

S·ª≠ d·ª•ng **key** m≈©i t√™n tr√™n m√†n h√¨nh ƒë·ªÉ k√©o l√™n, xu·ªëng, tr√°i, ph·∫£i cho m√†n h√¨nh hi·ªán th·ªã. Nh·∫•n ƒë·ªÉ ph√≠m **spacebar** s·∫Ω cu·ªôn v·ªÅ tr∆∞·ªõc trong khi nh·∫Øn gi·ªØ ph√≠m **`b`** s·∫Ω cu·ªôn v·ªÅ sau.

ƒê·ªÉ tho√°t **`less`** h√£y s·ª≠ d·ª•ng ph√≠m **`q`**.

### T√¨m khi·∫øm b·∫±ng **`less`**

**`less`** c≈©ng c√≥ kh·∫£ nƒÉng t√¨m ki·∫øm th√¥ng qua ƒë·∫ßu ra. ƒê·ªÉ t√¨m ki·∫øm h√£y nh·∫Øn gi·ªØ ph√≠m **`/`** v√† **enter** ƒë·ªÉ b·∫≠t ch·∫ø ƒë·ªô **search**, nh·∫≠p t·ª´ kho√° ho·∫∑c m·∫´u b·∫°n mu·ªën t√¨m ki·∫øm. **`less`** s·∫Ω cho b·∫°n m·∫´u ƒë·∫ßu ti√™n m√† n√≥ t√¨m ƒë∆∞·ª£c, N·∫øu b·∫°n mu·ªën tr·ªü v·ªÅ k√Ω t·ª± ti·∫øp theo n√≥ t√¨m ƒë∆∞·ª£c, h√£y g√µ ph√≠m **`?`**

M·ªôt s·ªë **ƒëi·ªÅu h∆∞·ªõng** trong ph·ªï bi·∫øn:

- ƒê·ªÉ xem l√πi v·ªÅ ph√≠a tr∆∞·ªõc
  - Nh·∫•n **`n`**
  - g√µ **`/`** v√† nh·∫•n **enter**
- ƒê·ªÉ xem ti·∫øp theo ph√≠a sau
  - nh·∫•n **`N`**
  - g√µ **`?`**  v√† nh·∫•n **enter**

### Ti·ªÅn nhi·ªám c·ªßa **`less`**

Theo c√πng m·ªôt c√°ch r·∫±ng **`bash`** (*the Bourne Again Shell*) d·ª±a tr√™n ti·ªÅn nhi·ªám c·ªßa n√≥ l√† **`sh`** (*the Bourne Shell*), **`less`** d·ª±a tr√™n ti·ªÅn nhi·ªám c·ªßa n√≥ l√† **`more`**. L·ªánh **`more`** t·ªìn t·∫°i trong h·∫ßu h·∫øt c√°c h·ªá th·ªëng nh∆∞ng n√≥ c√≥ nhi·ªÅu gi·ªõi h·∫°n h∆°n l·ªánh **`less`**.

**V√≠ d·ª•:** V·ªõi l·ªánh **`more`** s·∫Ω kh√¥ng th·ªÉ cu·ªôn v·ªÅ sau

### ƒê·ªçc h∆∞·ªõng d·∫´n

H√£y ch·∫°y l·ªánh **`man less`** ƒë·ªÉ ƒë·ªçc h∆∞·ªõng d·∫´n v√† c√°ch s·ª´ d·ª•ng **`less`**

### T√¨m hi·ªÉu th√™m

| üåè [So s√°nh m√°y tin nh·∫Øn](http://unix.stackexchange.com/questions/81129/what-are-the-differences-between-most-more-and-less) | üìù [H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng less](http://man7.org/linux/man-pages/man1/less.1.html) |
| ---------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------- |

---

## 3. Ch·ªçn ph·∫ßn c·ªßa m·ªôt d√≤ng s·ª≠ d·ª•ng **`cut`**

L·ªánh **`cut`** cho ph√©p ch√∫ng ta (*cut out*) x√°c ƒë·ªãnh ph·∫ßn c·ªßa m·ªói d√≤ng trong **file**. B·∫°n c√≥ th·ªÉ vu·ªôt qua t√™n c·ªßa m·ªôt **file** ƒë·ªÉ **`cut`** tr·ª±c ti·∫øp ho·∫∑c qua ƒë·∫ßu ra c·ªßa n√≥ t·ª´ m·ªôt ch∆∞∆°ng tr√¨nh kh√°c th√¥ng qua to√°n t·ª≠ **`|`**

ƒê√¢y l√† m·ªôt s·ªë **v√≠ d·ª• c∆° b·∫£n**:

### C·∫Øt k√Ω t·ª±

Tu·ª≥ ch·ªçn **`-c`** g·ªçi **`cut`** ƒë·ªÉ ch·ªçn k√Ω t·ª± t·ª´ ƒë·∫ßu v√†o:

```shell
$ echo "one:two:three" | cut -c2
n
$ echo "one:two:three" | cut -c1-5
one:t
```

Trong tr∆∞·ªùng h·ª£p n√†y, **`-c2`** g·ªçi l·ªánh **`cut`** ch·ªçn k√Ω t·ª± th·ª© 2 trong khi **`-c1-5`** g·ªçi l·ªánh **`cut`** ch·ªçn ƒë·ªô d√†i c·ªßa k√Ω t·ª±  (t·ª´ k√Ω t·ª± th·ª© 1 ƒë·∫øn th·ª© 5).

N√≥ c≈©ng c√≥ th·ªÉ ch·ªçn x√°c ƒë·ªãnh k√Ω t·ª± b·∫±ng c√°ch s·ª≠ d·ª•ng **`,`** thay v√¨ **`-`**.

**V√≠ d·ª•:** **`-c1,3,5`** t·ª©c l√† ch·ªçn k√Ω t·ª± th·ª© 1,3 v√† 5 m·ªói d√≤ng c·ªßa ƒë·∫ßu v√†o 

### C·∫Øt theo v√πng

Ch√∫ng ta c√≥ th·ªÉ c·∫Øt ra c·ªôt ho·∫∑c v√πng, xem **v√≠ d·ª• sau:**

```shell
$ echo "one:two:three" | cut -d":" -f1
one
$ echo "one:two:three" | cut -d":" -f2
two 
$ echo "one:two:three" | cut -d":" -f1-2
```

Tu·ª≥ ch·ªçn **`-d":"`** t·ª©c l√† xem x√©t ƒë·∫ßu v√†o ƒë∆∞·ª£c ph√¢n t√°ch b·ªüi k√Ω t·ª± **`:`**.  **`-f1`** t·ª©c l√† ch·ªçn v√πng ƒë·∫ßu ti√™n (*ph√¢n c√°ch b·ªüi d·∫•u **`:`**) v√† **`-f1-2`** t·ª©c l√† ch·ªçn v√πng th·ª© 1 v√† th·ª© 2.

N√≥ c√≥ th·ªÉ s·ª≠ d·ª•ng **`-f`** m√† kh√¥ng c·∫ßn **`-d`**, m·∫∑c d√π m·∫∑c ƒë·ªãnh th√¨ **`cut`** gi·∫£ ƒë·ªãnh r·∫±ng ƒë·∫ßu v√†o c·ªßa v√πng ƒë∆∞·ª£c gi·ªõi h·∫°n b·ªüi k√Ω t·ª± **`tab`**.

### V√≠ d·ª• th·ª±c t·∫ø

**file** **``/etc/passwd``** ch·ª©a th√¥ng tin v·ªÅ m·ªçi ng∆∞·ªùi d√πng tr√™n h·ªá th·ªëng, bao g·ªìm **usernames** v√† **home directory**. ƒê·ªãnh d·∫°ng r·∫•t l√† chu·∫©n. H√£y theo d√µi v√≠ d·ª• sau ƒë√¢y s·∫Ω in ra m·ªçi ng∆∞·ªùi d√πng v·ªõi **home directory** c·ªßa h·ªç tr√™n h·ªá th·ªëng:

```shell
$ cut -d":" -f1,6 /etc/passwd
```

![2020-08-16 14.12.22.gif](https://raw.githubusercontent.com/Zenfection/Image/master/2020/08/16-14-14-00-2020-08-16%2014.12.22.gif)

V√πng c·ªßa **``/etc/passwd``** ƒë∆∞·ª£c ph√¢n c√°ch b·ªüi **`:`** v·ªõi v√πng ƒë·∫ßu ti√™n ch·ª©a **username** v√† d√πng th·ª© 2 ch·ª©a **home directory** c·ªßa ng∆∞·ªùi d√πng.

---
